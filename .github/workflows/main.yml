import os
import openai

openai.api_key = os.getenv("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")

response = openai.ChatCompletion.create(
  model="gpt-4",
  messages=[
    {
      "role": "system",
      "content": "Given the following SQL tables, your job is to write queries given a userâ€™s request.\n\n CREATE Table Patient (\n ProfileID int ,\n NHINumber nvarchar(20) ,\n IsNHIValidate bit ,\n Title nvarchar(50) ,\n FirstName nvarchar(200) ,\n MiddleName nvarchar(200) ,\n FamilyName nvarchar(200) ,\n FullName nvarchar(500) ,\n PreferredName nvarchar(50) ,\n OtherMaidenName nvarchar(50) ,\n MaritalStatusID int ,\n MaritalStatus nvarchar(50) ,\n GenderID int ,\n Gender nvarchar(100) ,\n DOB date ,\n Age int ,\n AgeType varchar(8) ,\n AgeGroup nvarchar(20) ,\n AgeInYears int ,\n IsAlive bit ,\n DeathDate datetime ,\n DOBSource nvarchar(50) ,\n PicturePath nvarchar(100) ,\n ConsentedtoShare bit ,\n PlaceofBirth nvarchar(500) ,\n CountryofBirthID int ,\n CountryOfBirth nvarchar(200) ,\n CellNumber nvarchar(50) ,\n DayPhone nvarchar(50) ,\n NightPhone nvarchar(50) ,\n Email nvarchar(60) ,\n SecondaryEmail nvarchar(50) ,\n PreferredContactMethod nvarchar(50) ,\n ConsentTextMessaging bit ,\n IsPortalUser bit ,\n IsActive bit ,\n IsDeleted bit ,\n InsertedBy nvarchar(500) ,\n UpdatedBy nvarchar(500) ,\n InsertedAt datetime ,\n UpdatedAt datetime ,\n IsSameAddress bit ,\n Notes nvarchar(-1) ,\n IsGenderSelfIdentified bit ,\n SexRelatedGender nvarchar(100) ,\n IsWorkedVisaRequired bit ,\n Balance decimal ,\n MedTechBalance decimal ,\n MedTechDATELASTPAY datetime ,\n MedTechDATELASTSTMT datetime ,\n RegisterStatus nvarchar(50) ,\n MedTechNOK nvarchar(-1) ,\n PracticeName nvarchar(100) ,\n CalculatedBalance decimal ,\n LastStatementDate datetime ,\n LastInvoiceDate datetime ,\n LastPaymentDate datetime ,\n ProviderName nvarchar(511) ,\n ChartNumber nvarchar(50) ,\n Extention nvarchar(50) ,\n PracticeRemarks nvarchar(-1) ,\n IsInsured bit ,\n InsuredRemarks nvarchar(500) ,\n SmokingType nvarchar(100) ,\n AccountHolder nvarchar(500) ,\n AccoundHolderEmployer nvarchar(200) ,\n IsComunityServiceCard bit ,\n ComunityServiceCardNo nvarchar(50) ,\n ComunityServiceCardExipryDate date ,\n ComunityServiceCardSighted bit ,\n IsHealthCard bit ,\n HealthCardNo nvarchar(50) ,\n HealthCardExpiryDate date ,\n HEalthCardSighted bit ,\n WINZ nvarchar(50) ,\n IsTransferOfRecords int ,\n TransferofRecordsRemarks nvarchar(500) ,\n EnrollmentType nvarchar(50) ,\n EnrollmentStatusID int ,\n EnrollmentStatus nvarchar(50) ,\n EnrollmentDate date ,\n EnrollmentMethod nvarchar(50) ,\n EnrollmentVerifier nvarchar(500) ,\n FundingStatusID int ,\n FundingStatus nvarchar(50) ,\n RejectionReason nvarchar(500) ,\n FundingFrom date ,\n FundingTo date ,\n AccountGroup varchar(50) ,\n GMSCode varchar(2) ,\n ResidentialStatus nvarchar(50) ,\n IsNKA bit ,\n IsNKDA bit ,\n IsHighCare bit ,\n HighCareReason nvarchar(250) ,\n IsCarePlan bit ,\n IsNewRegisteration bit ,\n IsOptOff bit ,\n IsOptOffACK bit ,\n IsBPGraph bit ,\n IsBMIGraph bit ,\n IsINRGraph bit ,\n IsHbA1cGraph bit ,\n ASRMarkStatus nvarchar(100) ,\n IsHeightGraph bit ,\n IsWeightGraph bit ,\n IsHcGraph bit ,\n NESStatus varchar(13) ,\n NESComments nvarchar(500) ,\n MedTechBalanceDate date ,\n IsHeartRate bit ,\n IsPremature bit ,\n PrematureWeek tinyint ,\n PatientPHOID int ,\n ConsultUpdatedAt datetime ,\n Occupation nvarchar(100) ,\n PermanentAddress nvarchar(500) ,\n DeprivationQuintile int ,\n UncertaintyCode nvarchar(10) ,\n PostalAddress nvarchar(500) ,\n TemporaryAddress nvarchar(500) ,\n EmergencyContact nvarchar(50) ,\n EmergencyContactName nvarchar(500) ,\n SecondaryContact nvarchar(50) ,\n SecondaryContactName nvarchar(500) ,\n City nvarchar(50) ,\n Suburb nvarchar(50) ,\n ProviderID int ,\n PracticeID int ,\n PortalRegistrationStatus nvarchar(20) ,\n RegistrationDate date ,\n MedTechID nvarchar(50) ,\n PermanentAddressLatitude float ,\n PermanentAddressLongitude float ,\n CityAreaID int ,\n SuburbTownID int ,\n CountryID int ,\n Country nvarchar(200) ,\n EthnicityID int ,\n Ethnicity nvarchar(250) ,\n ETHCODE nvarchar(50) ,\n ETHCODE2 nvarchar(50) ,\n SecondaryEthnicityID int ,\n SecondaryEthnicity nvarchar(250) ,\n ETHCODE3 nvarchar(50) ,\n EnrollmentID nvarchar(50) ,\n PHOName nvarchar(150) ,\n EnrollmentExpiryDate datetime ,\n IsConsentToShare bit ,\n PostalCode nvarchar(50) ,\n IsWorkVisa bit ,\n WorkVisaStartDate datetime ,\n WorkVisaExpiryDate datetime ,\n EnrollmentQuarter varchar(2) ,\n PracticeLocation nvarchar(100) ,\n AccountHolderTypeID tinyint ,\n PatientType varchar(7) ,\n BreastScreenID int ,\n BreastScreen nvarchar(50) ,\n IsPregnant bit ,\n PermanentAddressDeprivationDecile nvarchar(100) ,\n PermanentAddressDHBCode nvarchar(50) ,\n PermanentAddressDomicileCode nvarchar(50) ,\n PermanentAddressMeshblock nvarchar(100) ,\n PermanentAddressMatchScore int ,\n PostalAddressDeprivationDecile nvarchar(100) ,\n PostalAddressDHBCode nvarchar(50) ,\n PostalAddressDomicileCode nvarchar(50) ,\n PostalAddressMeshblock nvarchar(100) ,\n PostalAddressMatchScore int ,\n PostalAddressDeprivationQuintile int ,\n PostalAddressLatitude float ,\n PostalAddressLongitude float ,\n ApplyCharges bit ,\n IncludeInPrint bit ,\n IsCareplus bit ,\n CarePlusStartDate datetime ,\n CarePlusEnddate datetime ,\n CarePlusLincStatusID int ,\n CarePlusLincStatus nvarchar(50) ,\n NHIStatusID int ,\n NHIStatus nvarchar(50) ,\n IsConsentToPrivateEmailAddress tinyint ,\n IsConsentForExperienceSurvey bit ,\n IsConsentToImportClinicalRecords tinyint ,\n IsConsentToShareClinicalRecords tinyint ,\n IsConsentToShareHealth1 tinyint ,\n IsConsentToShareMyRecordOnSEHR tinyint ,\n IsCapitated bit ,\n IsTestRecord bit ,\n PharmacyID int ,\n IsConsentAutoReminderTextMessaging bit  );"
    },
    {
      "role": "user",
      "content": "Write a SQL query which return patients with age greater than 45."
    }
  ],
  temperature=0,
  max_tokens=64,
  top_p=1.0,
  frequency_penalty=0.0,
  presence_penalty=0.0
)
